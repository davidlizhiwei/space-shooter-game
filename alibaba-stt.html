<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é˜¿é‡Œäº‘è¯­éŸ³è½¬æ–‡å­—</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      max-width: 600px;
      width: 100%;
      background: white;
      border-radius: 25px;
      padding: 40px;
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.3);
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 10px;
      font-size: 28px;
    }

    .subtitle {
      text-align: center;
      color: #888;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .logo {
      text-align: center;
      margin-bottom: 20px;
    }

    .logo-badge {
      display: inline-block;
      padding: 8px 16px;
      background: linear-gradient(135deg, #11998e, #38ef7d);
      color: white;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }

    /* ä¸Šä¼ åŒºåŸŸ */
    .upload-section {
      margin-bottom: 25px;
    }

    .upload-area {
      border: 3px dashed #ccc;
      border-radius: 15px;
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: #fafafa;
    }

    .upload-area:hover {
      border-color: #11998e;
      background: #f0fff8;
    }

    .upload-area.dragover {
      border-color: #11998e;
      background: #e8f9f3;
    }

    .upload-icon {
      font-size: 60px;
      margin-bottom: 15px;
    }

    .upload-text {
      color: #666;
      font-size: 16px;
      margin-bottom: 10px;
    }

    .upload-hint {
      color: #999;
      font-size: 13px;
    }

    .file-input {
      display: none;
    }

    /* æ–‡ä»¶ä¿¡æ¯ */
    .file-info {
      display: none;
      background: #f5f7fa;
      padding: 15px;
      border-radius: 12px;
      margin-top: 15px;
    }

    .file-info.show {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .file-icon {
      font-size: 30px;
    }

    .file-details {
      flex: 1;
    }

    .file-name {
      font-weight: 600;
      color: #333;
      margin-bottom: 4px;
    }

    .file-size {
      font-size: 12px;
      color: #888;
    }

    .remove-btn {
      padding: 8px 16px;
      background: #ff4757;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
    }

    /* é€‰é¡¹åŒºåŸŸ */
    .options-section {
      margin-bottom: 25px;
    }

    label {
      display: block;
      color: #555;
      font-weight: 600;
      margin-bottom: 10px;
    }

    select {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 14px;
      background: white;
      cursor: pointer;
    }

    /* è½¬æ¢æŒ‰é’® */
    .convert-btn {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #11998e, #38ef7d);
      color: white;
      border: none;
      border-radius: 15px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }

    .convert-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(17, 153, 142, 0.4);
    }

    .convert-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* åŠ è½½åŠ¨ç”» */
    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }

    .loading.show {
      display: block;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #e0e0e0;
      border-top-color: #11998e;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      color: #888;
      font-size: 14px;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 15px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #11998e, #38ef7d);
      width: 0%;
      transition: width 0.3s;
    }

    /* ç»“æœåŒºåŸŸ */
    .result-section {
      margin-top: 30px;
      padding-top: 30px;
      border-top: 2px solid #eee;
      display: none;
    }

    .result-section.show {
      display: block;
    }

    .result-text {
      width: 100%;
      min-height: 200px;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      font-size: 15px;
      line-height: 1.8;
      color: #333;
      resize: vertical;
      font-family: inherit;
    }

    .result-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .action-btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }

    .copy-btn {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }

    .export-btn {
      background: linear-gradient(135deg, #f093fb, #f5576c);
      color: white;
    }

    /* æç¤º */
    .tip {
      background: #f5f7fa;
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
      font-size: 13px;
      color: #666;
      line-height: 1.6;
    }

    .tip strong {
      color: #11998e;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <span class="logo-badge">ğŸ¤ é˜¿é‡Œäº‘é€šä¹‰å¬æ‚Ÿ</span>
    </div>

    <h1>è¯­éŸ³è½¬æ–‡å­—</h1>
    <p class="subtitle">Speech to Text - é«˜ç²¾åº¦è¯­éŸ³è¯†åˆ«</p>

    <!-- ä¸Šä¼ åŒºåŸŸ -->
    <div class="upload-section">
      <div class="upload-area" id="upload-area" onclick="document.getElementById('file-input').click()">
        <div class="upload-icon">ğŸ“</div>
        <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶</div>
        <div class="upload-hint">æ”¯æŒ MP3, WAV, M4A, FLAC ç­‰æ ¼å¼ï¼Œæœ€å¤§ 100MB</div>
      </div>
      <input type="file" id="file-input" class="file-input" accept="audio/*" onchange="handleFileSelect(event)">

      <div class="file-info" id="file-info">
        <span class="file-icon">ğŸµ</span>
        <div class="file-details">
          <div class="file-name" id="file-name">filename.mp3</div>
          <div class="file-size" id="file-size">5.2 MB</div>
        </div>
        <button class="remove-btn" onclick="removeFile()">ç§»é™¤</button>
      </div>
    </div>

    <!-- é€‰é¡¹åŒºåŸŸ -->
    <div class="options-section">
      <label for="language-select">è¯†åˆ«è¯­è¨€</label>
      <select id="language-select">
        <option value="zh-CN">ä¸­æ–‡æ™®é€šè¯</option>
        <option value="zh-HK">ä¸­æ–‡ç²¤è¯­</option>
        <option value="en-US">è‹±è¯­</option>
        <option value="ja-JP">æ—¥è¯­</option>
        <option value="ko-KR">éŸ©è¯­</option>
      </select>
    </div>

    <!-- è½¬æ¢æŒ‰é’® -->
    <button class="convert-btn" id="convert-btn" onclick="convertSpeech()">
      <span>ğŸ“</span>
      <span>å¼€å§‹è½¬æ¢</span>
    </button>

    <!-- åŠ è½½åŠ¨ç”» -->
    <div class="loading" id="loading">
      <div class="spinner"></div>
      <div class="loading-text">æ­£åœ¨è¯†åˆ«è¯­éŸ³ï¼Œè¯·ç¨å€™...</div>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
    </div>

    <!-- ç»“æœåŒºåŸŸ -->
    <div class="result-section" id="result-section">
      <label>è¯†åˆ«ç»“æœ</label>
      <textarea class="result-text" id="result-text" readonly></textarea>
      <div class="result-actions">
        <button class="action-btn copy-btn" onclick="copyResult()">ğŸ“‹ å¤åˆ¶æ–‡æœ¬</button>
        <button class="action-btn export-btn" onclick="exportResult()">ğŸ’¾ å¯¼å‡º TXT</button>
      </div>
    </div>

    <!-- æç¤º -->
    <div class="tip">
      <strong>ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š</strong><br>
      1. æœ¬å·¥å…·ä½¿ç”¨é˜¿é‡Œäº‘é€šä¹‰å¬æ‚Ÿè¯­éŸ³è¯†åˆ« API<br>
      2. æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼ï¼šMP3, WAV, M4A, FLAC<br>
      3. å•ä¸ªæ–‡ä»¶æœ€å¤§ 100MBï¼Œæ—¶é•¿ä¸è¶…è¿‡ 2 å°æ—¶<br>
      4. è¯†åˆ«å‡†ç¡®ç‡é«˜ï¼Œæ”¯æŒå˜ˆæ‚ç¯å¢ƒè¯†åˆ«
    </div>
  </div>

  <script>
    let selectedFile = null;

    // æ‹–æ‹½ä¸Šä¼ 
    const uploadArea = document.getElementById('upload-area');

    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        handleFile(files[0]);
      }
    });

    // æ–‡ä»¶é€‰æ‹©
    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (file) {
        handleFile(file);
      }
    }

    function handleFile(file) {
      // æ£€æŸ¥æ–‡ä»¶ç±»å‹
      if (!file.type.startsWith('audio/')) {
        alert('è¯·ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶');
        return;
      }

      // æ£€æŸ¥æ–‡ä»¶å¤§å°
      if (file.size > 100 * 1024 * 1024) {
        alert('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 100MB');
        return;
      }

      selectedFile = file;

      // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
      document.getElementById('file-name').textContent = file.name;
      document.getElementById('file-size').textContent = formatFileSize(file.size);
      document.getElementById('file-info').classList.add('show');
    }

    function formatFileSize(bytes) {
      if (bytes < 1024) return bytes + ' B';
      if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
      return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
    }

    function removeFile() {
      selectedFile = null;
      document.getElementById('file-input').value = '';
      document.getElementById('file-info').classList.remove('show');
    }

    // è½¬æ¢è¯­éŸ³
    async function convertSpeech() {
      if (!selectedFile) {
        alert('è¯·å…ˆä¸Šä¼ éŸ³é¢‘æ–‡ä»¶');
        return;
      }

      const language = document.getElementById('language-select').value;

      // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
      document.getElementById('loading').classList.add('show');
      document.getElementById('convert-btn').disabled = true;
      document.getElementById('result-section').classList.remove('show');

      // æ¨¡æ‹Ÿè¿›åº¦
      let progress = 0;
      const progressInterval = setInterval(() => {
        progress += Math.random() * 20;
        if (progress > 90) progress = 90;
        document.getElementById('progress-fill').style.width = progress + '%';
      }, 500);

      try {
        // è°ƒç”¨é˜¿é‡Œäº‘è¯­éŸ³è¯†åˆ« API
        const formData = new FormData();
        formData.append('audio', selectedFile);
        formData.append('language', language);

        // æ³¨æ„ï¼šå®é™…ä½¿ç”¨æ—¶éœ€è¦æ›¿æ¢ä¸ºçœŸå®çš„ API è°ƒç”¨
        // è¿™é‡Œæ˜¯ç¤ºä¾‹ä»£ç ï¼Œå®é™…éœ€è¦åç«¯æœåŠ¡é…åˆ
        const response = await fetch('https://dashscope.aliyuncs.com/api/v1/services/speech/transcription', {
          method: 'POST',
          headers: {
            'Authorization': 'Bearer YOUR_DASHSCOPE_API_KEY'
          },
          body: formData
        });

        if (!response.ok) {
          throw new Error('è½¬æ¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥ API é…ç½®');
        }

        const result = await response.json();

        // æ¸…é™¤è¿›åº¦å®šæ—¶å™¨
        clearInterval(progressInterval);
        document.getElementById('progress-fill').style.width = '100%';

        // æ˜¾ç¤ºç»“æœ
        setTimeout(() => {
          document.getElementById('result-text').value = result.text || 'è¯†åˆ«ç»“æœ';
          document.getElementById('loading').classList.remove('show');
          document.getElementById('result-section').classList.add('show');
          document.getElementById('convert-btn').disabled = false;
        }, 500);

      } catch (error) {
        console.error('è½¬æ¢å¤±è´¥:', error);
        clearInterval(progressInterval);
        alert('è½¬æ¢å¤±è´¥ï¼š' + error.message);
        document.getElementById('loading').classList.remove('show');
        document.getElementById('convert-btn').disabled = false;
      }
    }

    // å¤åˆ¶ç»“æœ
    function copyResult() {
      const resultText = document.getElementById('result-text');
      resultText.select();
      document.execCommand('copy');
      alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
    }

    // å¯¼å‡ºç»“æœ
    function exportResult() {
      const text = document.getElementById('result-text').value;
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `transcription-${Date.now()}.txt`;
      link.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
